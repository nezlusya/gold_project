# Платформа аналитики и прогнозирования цен на золото

Аналитическая и ML-платформа для сбора, хранения, обработки и прогнозирования цен на золото

---

## О проекте

Данный проект реализует полный цикл работы с данными:

* автоматизированный сбор исторических данных о цене золота
* построение аналитического хранилища (DWH)
* обучение и сравнение нескольких ML-моделей
* хранение, версионирование и управление моделями
* автоматический перевод лучшей модели в Production
* регулярная генерация прогнозов
* визуализация данных и прогнозов в интерактивном интерфейсе

## Пример работы
  <img width="800" alt="Работы программы" src="https://github.com/nezlusya/gold_project/blob/main/photo/streamlit 1.png" />

Проект построен по принципам:

* Data Lake + DWH
* MLOps
* Оркестрация пайплайнов
* Автоматизация жизненного цикла модели

---


# Технологический стек

| Компонент        | Технология     |
| ---------------- | -------------- |
| Оркестрация      | Apache Airflow |
| ML tracking      | MLflow         |
| Хранилище данных | PostgreSQL     |
| Аналитическая БД | ClickHouse     |
| Data Lake        | MinIO (S3)     |
| Визуализация     | Streamlit      |
| BI               | Superset       |
| Контейнеризация  | Docker         |
| Язык             | Python 3.10+   |

---

# Подробное описание реализации

## 1 Получение данных

**Источник данных:** API Центрального Банка РФ  
**Оркестрация:** Apache Airflow  

### Что реализовано:

- DAG для регулярного получения данных
- Загрузка сырья в MinIO (raw слой)
- Поддержка повторных запусков
- Разделение логики extraction и loading
- Логирование шагов пайплайна

### Зачем:

- Обеспечивает отказоустойчивость
- Позволяет хранить "сырой" слой данных
- Делает пайплайн расширяемым

## 2 Data Lake (MinIO)

Используется S3-совместимое хранилище MinIO.

### Почему MinIO:

- Локальный S3-аналог
- Используется MLflow как artifact storage
- Позволяет реализовать озеро данных
- Удобен для контейнеризации

---

## 3 Data Warehouse (PostgreSQL)

PostgreSQL используется как:

- Хранилище аналитических таблиц
- Backend-store для MLflow
- Источник данных для Superset

### Реализовано:

- Разделение слоёв:
- SQL-трансформации
- Агрегации
- Подготовка датасета для ML

### Почему PostgreSQL:

- Хорошая интеграция с BI
- Надёжность
- ACID-гарантии

---

## 4 Аналитический слой (ClickHouse)

В проекте используется ClickHouse как высокопроизводительная аналитическая база данных для OLAP-нагрузки.

### Реализовано:

- Подключение ClickHouse как отдельного аналитического слоя
- Интеграция с Superset
- Агрегации
- Быстрые выборки для BI-дашбордов
- Разделение нагрузки между OLTP (Postgres) и OLAP (ClickHouse)

### Почему ClickHouse:

- Высокая скорость агрегаций
- Работа с большими объёмами данных
- Быстрые группировки и временные срезы
- Минимальная задержка ответа для визуализаций

---
## 5 Оркестрация (Airflow)

Airflow управляет:

- получением данных
- трансформациями
- обучением моделей
- генерацией прогнозов

### Фишки реализации:

- Разделение DAG по логическим слоям
- Dependency management
- Retry-политики
- Параметризация

### Зачем:

- Автоматизация всего пайплайна
- Масштабируемость

---

## 6 Machine Learning Pipeline

Реализован полноценный ML жизненный цикл.

### Что реализовано:

- Обучение нескольких моделей:
  - Linear Regression
  - Random Forest
  - (при необходимости Prophet)
- Разделение train/test
- Вычисление метрик:
  - MAE
  - RMSE
  - R²
- Логирование экспериментов в MLflow
- Автоматический выбор лучшей модели
- Регистрация модели в Model Registry

---

## 7 MLflow (MLOps слой)

MLflow используется для:

- Tracking экспериментов
- Хранения артефактов
- Model Registry
- Управления stage (Staging → Production)

### Особенности реализации:

- Backend-store в PostgreSQL
- Artifact store в MinIO
- Автоматическая регистрация лучшей модели
- Версионирование
- Возможность отката к предыдущей версии

Это приближает проект к реальным production ML системам.

---

## 8 Prediction Pipeline

Отдельный DAG:

- Загружает production-модель
- Генерирует прогноз
- Сохраняет прогноз в postgres
- Делает данные доступными для BI

---

## 9 BI слой (Superset)

Superset используется для:

- визуализации исторических данных
- отображения прогноза
- сравнения факта и предсказания
- построения аналитических дашбордов

### Реализовано:

- Подключение к PostgreSQL, Clickhouse
- Дашборд с динамикой цен
- График прогноза
- Аналитические метрики

---

---

# Как запустить проект

## 1. Клонировать репозиторий

```
git clone https://github.com/nezlusya/gold_project.git
cd gold_project
```

## 2. Запустить инфраструктуру

```
docker compose up -d
```

## 3. Доступ к сервисам

| Сервис    | URL                                            |
| --------- | ---------------------------------------------- |
| Airflow   | [http://localhost:8080](http://localhost:8080) |
| MLflow    | [http://localhost:5000](http://localhost:5000) |
| Streamlit | [http://localhost:8501](http://localhost:8501) |
| Superset  | [http://localhost:8088](http://localhost:8088) |


